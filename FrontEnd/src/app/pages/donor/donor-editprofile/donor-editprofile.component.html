<app-navbar-donor></app-navbar-donor>
<div class="flex justify-center">
  <div class="bg-white mt-20 border-0 shadow-2xl w-[90%] lg:w-[40%] p-5 rounded-2xl h-auto">
    <p class="text-red-700 font-bold text-center">Edit profile</p>
    
    <!-- Success/Error Message -->
    <div *ngIf="message" class="mb-4 p-3 rounded-lg" 
         [class.bg-green-100]="message.includes('successfully')"
         [class.text-green-700]="message.includes('successfully')"
         [class.bg-red-100]="!message.includes('successfully')"
         [class.text-red-700]="!message.includes('successfully')">
      {{ message }}
    </div>

    <form (ngSubmit)="onSubmit()" #updateprofile="ngForm" novalidate>
      <!-- Full Name -->
      <div class="ps-4 p-2 rounded-xl">
        <p class="text-red-700 font-medium">FULL NAME</p>
        <input
          type="text"
          id="name"
          name="name"
          [(ngModel)]="updateData.name"
          #nameField="ngModel"
          required
          minlength="2"
          maxlength="50"
          pattern="^[a-zA-Z\s]+$"
          class="font-medium w-[100%] rounded-2xl border p-2"
          [class.border-red-500]="nameField.invalid && (nameField.dirty || nameField.touched)"
          [class.border-green-500]="nameField.valid && (nameField.dirty || nameField.touched)"
          placeholder="Enter your full name"
        />
        <div *ngIf="nameField.invalid && (nameField.dirty || nameField.touched)" class="text-red-500 text-sm mt-1">
          <div *ngIf="nameField.errors?.['required']">Name is required</div>
          <div *ngIf="nameField.errors?.['minlength']">Name must be at least 2 characters long</div>
          <div *ngIf="nameField.errors?.['maxlength']">Name cannot exceed 50 characters</div>
          <div *ngIf="nameField.errors?.['pattern']">Name can only contain letters and spaces</div>
        </div>
      </div>
      
      <!-- Email -->
      <div class="ps-4 p-2 rounded-xl">
        <p class="text-red-700 font-medium">EMAIL ADDRESS</p>
        <input
          type="email"
          id="email"
          name="email"
          [(ngModel)]="updateData.email"
          #emailField="ngModel"
          required
          email
          class="font-medium w-[100%] rounded-2xl border p-2"
          [class.border-red-500]="emailField.invalid && (emailField.dirty || emailField.touched)"
          [class.border-green-500]="emailField.valid && (emailField.dirty || emailField.touched)"
          placeholder="Enter your email address"
        />
        <div *ngIf="emailField.invalid && (emailField.dirty || emailField.touched)" class="text-red-500 text-sm mt-1">
          <div *ngIf="emailField.errors?.['required']">Email is required</div>
          <div *ngIf="emailField.errors?.['email']">Please enter a valid email address</div>
        </div>
      </div>
      
      <!-- Age -->
      <div class="ps-4 p-2 rounded-xl">
        <p class="text-red-700 font-medium">AGE</p>
        <input
          type="number"
          id="age"
          name="age"
          [(ngModel)]="updateData.age"
          #ageField="ngModel"
          required
          min="18"
          max="65"
          class="font-medium w-[100%] rounded-2xl border p-2"
          [class.border-red-500]="ageField.invalid && (ageField.dirty || ageField.touched)"
          [class.border-green-500]="ageField.valid && (ageField.dirty || ageField.touched)"
          placeholder="Enter your age"
        />
        <div *ngIf="ageField.invalid && (ageField.dirty || ageField.touched)" class="text-red-500 text-sm mt-1">
          <div *ngIf="ageField.errors?.['required']">Age is required</div>
          <div *ngIf="ageField.errors?.['min']">Age must be at least 18</div>
          <div *ngIf="ageField.errors?.['max']">Age cannot exceed 65</div>
        </div>
      </div>
      
      <!-- Phone Number -->
      <div class="ps-4 p-2 rounded-xl">
        <p class="text-red-700 font-medium">PHONE NUMBER</p>
        <input
          type="tel"
          id="phone"
          name="phone"
          [(ngModel)]="updateData.phone"
          #phoneField="ngModel"
          required
          pattern="^[0-9]{10}$"
          class="font-medium w-[100%] rounded-2xl border p-2"
          [class.border-red-500]="phoneField.invalid && (phoneField.dirty || phoneField.touched)"
          [class.border-green-500]="phoneField.valid && (phoneField.dirty || phoneField.touched)"
          placeholder="Enter your 10-digit phone number"
        />
        <div *ngIf="phoneField.invalid && (phoneField.dirty || phoneField.touched)" class="text-red-500 text-sm mt-1">
          <div *ngIf="phoneField.errors?.['required']">Phone number is required</div>
          <div *ngIf="phoneField.errors?.['pattern']">Phone number must be exactly 10 digits</div>
        </div>
      </div>
      
      <!-- Blood Group -->
      <div class="ps-4 p-2 rounded-xl">
        <p class="text-red-700 font-medium">BLOOD GROUP</p>
        <select
          id="bloodgroup"
          name="bloodgroup"
          [(ngModel)]="updateData.blood_group"
          #bloodGroupField="ngModel"
          required
          class="font-medium w-[100%] rounded-2xl border p-2"
          [class.border-red-500]="bloodGroupField.invalid && (bloodGroupField.dirty || bloodGroupField.touched)"
          [class.border-green-500]="bloodGroupField.valid && (bloodGroupField.dirty || bloodGroupField.touched)"
        >
          <option value="" disabled>Select blood group</option>
          <option value="A+">A+</option>
          <option value="A-">A-</option>
          <option value="B+">B+</option>
          <option value="B-">B-</option>
          <option value="AB+">AB+</option>
          <option value="AB-">AB-</option>
          <option value="O+">O+</option>
          <option value="O-">O-</option>
        </select>
        <div *ngIf="bloodGroupField.invalid && (bloodGroupField.dirty || bloodGroupField.touched)" class="text-red-500 text-sm mt-1">
          <div *ngIf="bloodGroupField.errors?.['required']">Blood group is required</div>
        </div>
      </div>
      
      <!-- Location -->
      <div class="ps-4 p-2 rounded-xl">
        <p class="text-red-700 font-medium">LOCATION</p>
        <input
          type="text"
          id="location"
          name="location"
          [(ngModel)]="updateData.location"
          #locationField="ngModel"
          required
          minlength="2"
          maxlength="100"
          class="font-medium w-[100%] rounded-2xl border p-2"
          [class.border-red-500]="locationField.invalid && (locationField.dirty || locationField.touched)"
          [class.border-green-500]="locationField.valid && (locationField.dirty || locationField.touched)"
          placeholder="Enter your location"
        />
        <div *ngIf="locationField.invalid && (locationField.dirty || locationField.touched)" class="text-red-500 text-sm mt-1">
          <div *ngIf="locationField.errors?.['required']">Location is required</div>
          <div *ngIf="locationField.errors?.['minlength']">Location must be at least 2 characters long</div>
          <div *ngIf="locationField.errors?.['maxlength']">Location cannot exceed 100 characters</div>
        </div>
      </div>
      
      <!-- Submit Button -->
      <button
        type="submit"
        [disabled]="!updateprofile.form.valid || isLoading"
        class="cursor-pointer border-0 text-white font-bold text-xl w-[100%] mt-4 p-2 rounded-4xl bg-[#C0392B] disabled:opacity-50 disabled:cursor-not-allowed"
      >
        <span *ngIf="isLoading">Updating...</span>
        <span *ngIf="!isLoading">Update Profile</span>
      </button>
      
      <!-- Form Status Debug (remove in production) -->
      <div *ngIf="!updateprofile.form.valid" class="mt-2 text-sm text-gray-600">
        <p>Please fix the errors above to enable the submit button.</p>
      </div>
    </form>
  </div>
</div>